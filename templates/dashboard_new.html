{% extends "base.html" %}

{% block title %}Dashboard - {{ page_info.company_name }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Üdvözöljük, {{ page_info.company_name }}!</h1>
    <p>Itt egy gyors áttekintés a mai napról</p>
</div>

<div class="stats-grid">
    <div class="stat-card" style="animation-delay: 0.1s;">
        <div class="stat-header">
            <div class="stat-icon">
                <i data-lucide="users" style="color: white; width: 24px; height: 24px;"></i>
            </div>
        </div>
        <div class="number">{{ total_leads }}</div>
        <div class="label">Összes beteg</div>
    </div>

    <div class="stat-card" style="animation-delay: 0.2s;">
        <div class="stat-header">
            <div class="stat-icon">
                <i data-lucide="clock" style="color: white; width: 24px; height: 24px;"></i>
            </div>
        </div>
        <div class="number">{{ pending_appointments }}</div>
        <div class="label">Függőben lévő foglalások</div>
    </div>

    <div class="stat-card" style="animation-delay: 0.3s;">
        <div class="stat-header">
            <div class="stat-icon">
                <i data-lucide="calendar-check" style="color: white; width: 24px; height: 24px;"></i>
            </div>
        </div>
        <div class="number">{{ today_appointments }}</div>
        <div class="label">Mai időpontok</div>
    </div>

    <div class="stat-card" style="animation-delay: 0.4s;">
        <div class="stat-header">
            <div class="stat-icon">
                <i data-lucide="trending-up" style="color: white; width: 24px; height: 24px;"></i>
            </div>
        </div>
        <div class="number">{{ this_week_leads }}</div>
        <div class="label">Ezen a héten érkezett</div>
    </div>
</div>

<div class="card" style="animation-delay: 0.5s;">
    <h2>
        <i data-lucide="list" style="width: 20px; height: 20px;"></i>
        Legutóbbi foglalások
    </h2>
    
    {% if recent_leads %}
    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 2px solid var(--border);">
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--text-muted); font-size: 13px;">NÉV</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--text-muted); font-size: 13px;">TELEFON</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--text-muted); font-size: 13px;">IDŐPONT</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--text-muted); font-size: 13px;">STÁTUSZ</th>
                </tr>
            </thead>
            <tbody>
                {% for lead in recent_leads[:5] %}
                <tr style="border-bottom: 1px solid var(--border); transition: background 0.2s;" onmouseover="this.style.background='var(--surface-hover)'" onmouseout="this.style.background='transparent'">
                    <td style="padding: 16px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), #8b5cf6); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                                {{ lead.name[0].upper() }}
                            </div>
                            <strong>{{ lead.name }}</strong>
                        </div>
                    </td>
                    <td style="padding: 16px; color: var(--text-muted);">{{ lead.phone }}</td>
                    <td style="padding: 16px;">
                        {% if lead.veglegesitett_idopont %}
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <i data-lucide="calendar" style="width: 16px; height: 16px; color: var(--text-muted);"></i>
                            <span>{{ lead.veglegesitett_idopont }}</span>
                        </div>
                        {% else %}
                        <span style="color: var(--text-muted);">Nincs beállítva</span>
                        {% endif %}
                    </td>
                    <td style="padding: 16px;">
                        {% if lead.veglegesitett_idopont %}
                        <span style="background: rgba(16, 185, 129, 0.1); color: #10b981; padding: 6px 12px; border-radius: 8px; font-size: 13px; font-weight: 500; display: inline-flex; align-items: center; gap: 6px;">
                            <i data-lucide="check-circle" style="width: 14px; height: 14px;"></i>
                            Időpont van
                        </span>
                        {% else %}
                        <span style="background: rgba(251, 191, 36, 0.1); color: #fbbf24; padding: 6px 12px; border-radius: 8px; font-size: 13px; font-weight: 500; display: inline-flex; align-items: center; gap: 6px;">
                            <i data-lucide="clock" style="width: 14px; height: 14px;"></i>
                            Függőben
                        </span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: 60px 20px; color: var(--text-muted);">
        <i data-lucide="inbox" style="width: 48px; height: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
        <p>Még nincs foglalás</p>
    </div>
    {% endif %}
    
    <div style="margin-top: 24px; text-align: center;">
        <a href="/foglalasok" class="btn">
            <span>Összes foglalás megtekintése</span>
            <i data-lucide="arrow-right" style="width: 18px; height: 18px;"></i>
        </a>
    </div>
</div>

<script>
    lucide.createIcons();
</script>
{% endblock %}
